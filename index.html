<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <p class="newtweets"></p>
    <p class="oldtweets"></p>
    <script>

      $(document).ready(function(){
        var count = 0;
        var $par = $('.newtweets');
        var $par1 = $(".oldtweets");
        $par1.hide();
        $par.text('');
        var index = streams.home.length - 1;
        //adds a button
        $("body").prepend("<button class=archives>See Archives</button>")        
        $("body").prepend("<button class=refresh>Update Tweets</button>")

        
        while(index >= 0){
          var tweet = streams.home[index];
          var $tweet = $('<div></div>');
          $tweet.text(': ' + tweet.message +' (' + tweet.created_at.toLocaleString()+')'+" tweet# "+streams.home.indexOf(tweet));
          $span = $("<span class=username></span>");
          $span.text('@'+tweet.user);
          $tweet.prepend($span);
          $tweet.appendTo($par);
          index -= 1;
          count+=1;
        };        
        //adds click event to button to display new tweets on top of old ones, newest from top to bottom
        $("button").filter(".refresh").on("click",function(){
          var index = streams.home.length - 1;
          $("div").remove();
          var tempCount=0;          
          while(index > count){
            var tweet = streams.home[index];
            var $tweet = $('<div></div>');
            $tweet.text(': ' + tweet.message +' ('+ tweet.created_at.toLocaleString()+')'+" tweet# "+streams.home.indexOf(tweet));
            $span = $("<span class=username></span>");
            $span.text('@'+tweet.user);
            $tweet.prepend($span);
            $tweet.appendTo($par);
            index -= 1;
            tempCount += 1;
            
          };
          count += tempCount;
          $("p").filter(".newtweets").show()
          $("p").filter(".oldtweets").hide()                    
        });
        //adding a clickhandler for Archive button
        $("button").filter(".archives").on("click",function(){
          var index = count;
          $("div").remove();
          while(index >= 0){
            var tweet = streams.home[index];
            var $tweet = $('<div></div>');
            $tweet.text(': ' + tweet.message +' ('+ tweet.created_at.toLocaleString()+')'+" tweet# "+streams.home.indexOf(tweet));
            $span = $("<span class=username></span>");
            $span.text('@'+tweet.user);
            $tweet.prepend($span);
            $tweet.appendTo($par1);
            index -= 1;
            $("p").filter(".newtweets").hide()
            $("p").filter(".oldtweets").show()
          };          
        })
        //adding a clickhandler for username
        $('.username').on("click",function(){
          $(this).parent("div").append("waa waa wee wa")
        })

      });
    </script>
  </body>
</html>
